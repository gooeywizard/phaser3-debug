!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.phaser3Debugger=t():e.phaser3Debugger=t()}(window,function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function o(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i.r(t);var h=function(e,t){return"("+e+","+t+")"},u=function(e){return 180*e/Math.PI+" ("+e.toFixed(2)+")"},l=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=o(this,r(t).call(this,{key:"Debug",active:!1}));return i=Object.assign({props:["x","y","angle"],color:"#da4d4d",pauseKey:"P",pauseOnCollisions:!1,pauseOnCollisionsKey:"C",showBodies:!1,showBodiesKey:"B",slowDownGameKey:"OPEN_BRACKET",speedUpGameKey:"CLOSED_BRACKET",resetGameSpeedKey:"BACK_SLASH",showCornerCoords:!1,showDirectionAngles:!1,helpMenuKey:"ESC"},i),e.globalProps=i.props,e.style={font:"12px Arial",fill:i.color,stroke:i.color,strokeThickness:1},e.hotkeys={pause:i.pauseKey,pauseOnCollisions:i.pauseOnCollisionsKey,showBodies:i.showBodiesKey,slowDownGame:i.slowDownGameKey,speedUpGame:i.speedUpGameKey,resetGameSpeed:i.resetGameSpeedKey,helpMenu:i.helpMenuKey},e.pauseOnCollisions=i.pauseOnCollisions,e.showBodies=i.showBodies,e.showCornerCoords=i.showCornerCoords,e.showDirectionAngles=i.showDirectionAngles,e.gameDelay=0,e.debugScene={children:{list:[]}},e.debug=[],e}var i,s,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,Phaser.Scene),i=t,(s=[{key:"init",value:function(e){var t=this;for(var i in this.debugScene=e,this.events.on("prestep",function(e,i){for(var s=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-s>t.gameDelay);n++);}),this.initMenu(),this.showCornerCoords&&this.initCornerCoords(),this.showDirectionAngles&&this.initDirectionAngles(),this.showBodies&&this.enablePhysicsDebugging(),this.pauseOnCollisions&&this.enablePauseOnCollisions(),this.isDebuggable(this.debugScene)&&this.debug.push({entity:this.debugScene,hasPosition:!1}),this.debugScene)if(this.debugScene.hasOwnProperty(i)){var s=this.debugScene[i];this.isDebuggable(s)&&this.debug.push({entity:s,hasPosition:null!==this.getX(s)})}for(var n=this.debugScene.children.list,o=0;o<n.length;o++){var r=n[o];this.isDebuggable(r)&&this.debug.push({entity:r,hasPosition:null!==this.getX(r)})}for(var a=20,h=0;h<this.debug.length;h++){var u=this.debug[h];u.props=this.getProps(u.entity),u.text={};for(var l=this.getX(u.entity),d=this.getY(u.entity),y=0;y<u.props.length;y++){var c=u.props[y],p=this.getValue(u.entity,c);null===l&&(l=20,d=a+=16),u.text[c]=this.add.text(l,d+16*y,c+": "+p,this.style)}this.pauseOnCollisions&&u.entity.body&&this.addCollisionListener(u.entity.body)}this.gameDelayText=this.add.text(20,20,"Game Delay: "+this.gameDelay/1e3+"s",this.style),this.isPaused=!1,this.input.keyboard.on("keydown_"+this.hotkeys.pause,function(e){t.isPaused?t.resumeScene():t.pauseScene()}),this.input.keyboard.on("keydown_"+this.hotkeys.pauseOnCollisions,function(e){t.pauseOnCollisions?t.disablePauseOnCollisions():t.enablePauseOnCollisions()}),this.input.keyboard.on("keydown_"+this.hotkeys.showBodies,function(e){t.showBodies?t.disableShowBodies():t.enableShowBodies()}),this.input.keyboard.on("keydown_"+this.hotkeys.slowDownGame,function(e){t.slowDownGame()}),this.input.keyboard.on("keydown_"+this.hotkeys.speedUpGame,function(e){t.speedUpGame()}),this.input.keyboard.on("keydown_"+this.hotkeys.resetGameSpeed,function(e){t.resetGameSpeed()}),this.input.keyboard.on("keydown_"+this.hotkeys.helpMenu,function(e){t.toggleHelpMenu()})}},{key:"update",value:function(){this.gameDelay>0?this.gameDelayText.setText("Game Delay: "+this.gameDelay/1e3+"s"):this.gameDelayText.setText("");for(var e=0,t=0;t<this.debug.length;t++)for(var i=this.debug[t],s=this.getX(i.entity),n=this.getY(i.entity),o=0;o<i.props.length;o++){var r=i.props[o],a=this.getValue(i.entity,r),h=o;i.hasPosition||(s=20,n=36,h=e,e++);var u=i.text[r];u.setText(r+": "+a),u.x=s,u.y=n+16*h}}},{key:"isDebuggable",value:function(e){return!0===e.debug||e.debug instanceof Array}},{key:"getProps",value:function(e){return e.debug instanceof Array?e.debug:this.globalProps}},{key:"getValue",value:function(e,t){for(var i=t.split("."),s=e,n=0;n<i.length;n++)s=s[i[n]];return Number.isFinite(s)&&(s=s.toFixed(2)),s}},{key:"getX",value:function(e){return Number.isFinite(e.x)?e.x-e.width/2:e.sprite&&Number.isFinite(e.sprite.x)?e.sprite.x-e.sprite.width/2:e.body&&Number.isFinite(e.body.position.x)?e.body.position.x-e.body.width/2:null}},{key:"getY",value:function(e){return Number.isFinite(e.y)?e.y+e.height/2:e.sprite&&Number.isFinite(e.sprite.y)?e.sprite.y+e.sprite.height/2:e.body&&Number.isFinite(e.body.position.y)?e.body.position.y+e.body.height/2:null}},{key:"enablePhysicsDebugging",value:function(){this.debugScene.matter&&(this.debugScene.matter.world.createDebugGraphic(),this.debugScene.events.once("shutdown",this.disablePhysicsDebugging,this))}},{key:"disablePhysicsDebugging",value:function(){this.debugScene.matter&&(this.debugScene.matter.world.drawDebug=!1,this.debugScene.matter.world.debugGraphic.destroy(),this.debugScene.matter.world.debugGraphic=void 0)}},{key:"pauseScene",value:function(){this.scene.pause(this.debugScene.scene.key),this.isPaused=!0}},{key:"resumeScene",value:function(){this.scene.resume(this.debugScene.scene.key),this.isPaused=!1}},{key:"disablePauseOnCollisions",value:function(){this.pauseOnCollisions=!1,this.debugScene.matter&&Phaser.Physics.Matter.Matter.Events.off(this.debugScene.matter.world.engine,"collisionStart");for(var e=0;e<this.debug.length;e++){var t=this.debug[e].entity.body;t&&this.removeCollisionListener(t)}}},{key:"enablePauseOnCollisions",value:function(){this.pauseOnCollisions=!0,this.debugScene.matter&&Phaser.Physics.Matter.Matter.Events.on(this.debugScene.matter.world.engine,"collisionStart",function(e){for(var t=0;t<e.pairs.length;t++){var i=e.pairs[t];Phaser.Physics.Matter.Matter.Events.trigger(i.bodyA,"collision",{pair:i}),Phaser.Physics.Matter.Matter.Events.trigger(i.bodyB,"collision",{pair:i})}});for(var e=0;e<this.debug.length;e++){var t=this.debug[e].entity.body;t&&this.addCollisionListener(t)}}},{key:"addCollisionListener",value:function(e){var t=this;this.debugScene.matter&&Phaser.Physics.Matter.Matter.Events.on(e,"collision",function(e){t.pauseScene()})}},{key:"removeCollisionListener",value:function(e){this.debugScene.matter&&Phaser.Physics.Matter.Matter.Events.off(e,"collision")}},{key:"disableShowBodies",value:function(){this.showBodies=!1,this.disablePhysicsDebugging()}},{key:"enableShowBodies",value:function(){this.showBodies=!0,this.enablePhysicsDebugging()}},{key:"slowDownGame",value:function(){this.gameDelay+=10}},{key:"speedUpGame",value:function(){this.gameDelay-=10,this.gameDelay<0&&(this.gameDelay=0)}},{key:"resetGameSpeed",value:function(){this.gameDelay=0}},{key:"initMenu",value:function(){this.helpDisplayed=!0,this.helpText=[];var e={font:"14px Arial",fill:"#FFF",stroke:"##FFF",backgroundColor:"#000",strokeThickness:2},t=300,i=200;this.helpText.push(this.add.text(t,i,"Features",e)),this.helpText.push(this.add.text(t,224,"Pause On Collisions: "+(this.pauseOnCollisions?"Enabled":"Disabled"),e)),this.helpText.push(this.add.text(t,248,"Show Physics Bodies: "+(this.showBodies?"Enabled":"Disabled"),e)),this.helpText.push(this.add.text(t,272,"Game Delay: "+this.gameDelay/1e3+"s",e)),this.helpText.push(this.add.text(t,320,"Hotkeys",e));var s=6;for(var n in this.hotkeys)this.hotkeys.hasOwnProperty(n)&&(this.helpText.push(this.add.text(t,i+24*s,this.prettify(n)+": "+this.hotkeys[n],e)),s++);this.toggleHelpMenu()}},{key:"toggleHelpMenu",value:function(){if(this.helpDisplayed){this.helpDisplayed=!1,this.resumeScene();for(var e=0;e<this.helpText.length;e++)this.helpText[e].visible=!1}else{this.helpDisplayed=!0,this.pauseScene(),this.helpText[1].setText("Pause On Collisions: "+(this.pauseOnCollisions?"Enabled":"Disabled")),this.helpText[2].setText("Show Physics Bodies: "+(this.showBodies?"Enabled":"Disabled")),this.helpText[3].setText("Game Delay: "+this.gameDelay/1e3+"s");for(var t=0;t<this.helpText.length;t++)this.helpText[t].visible=!0}}},{key:"initCornerCoords",value:function(){var e,t,i,s=this.cameras.main;this.cornerCoords=[],e=s.x,t=s.y,i=this.add.text(e+5,t+5,h(e,t),this.style),this.cornerCoords.push(i),e=s.x+s.width,t=s.y,(i=this.add.text(e-5,t+5,h(e,t),this.style)).setOrigin(1,0),this.cornerCoords.push(i),e=s.x+s.width,t=s.y+s.height,(i=this.add.text(e-5,t-5,h(e,t),this.style)).setOrigin(1,1),this.cornerCoords.push(i),e=s.x,t=s.y+s.height,(i=this.add.text(e+5,t-5,h(e,t),this.style)).setOrigin(0,1),this.cornerCoords.push(i)}},{key:"initDirectionAngles",value:function(){var e,t,i,s,n=this.cameras.main;this.directions=[],i=0+n.rotation,e=n.x+n.width-5,t=n.y+n.height/2,(s=this.add.text(e,t,u(i),this.style)).setOrigin(1,.5),this.directions.push(s),i=Math.PI/2+n.rotation,e=n.x+n.width/2,t=n.y+n.height-5,(s=this.add.text(e,t,u(i),this.style)).setOrigin(.5,1),this.directions.push(s),i=Math.PI+n.rotation,e=n.x+5,t=n.y+n.height/2,(s=this.add.text(e,t,u(i),this.style)).setOrigin(0,.5),this.directions.push(s),i=3*Math.PI/2+n.rotation,e=n.x+n.width/2,t=n.y+5,(s=this.add.text(e,t,u(i),this.style)).setOrigin(.5,0),this.directions.push(s)}},{key:"prettify",value:function(e){for(var t="",i=0;i<e.length;i++){var s=e.charAt(i);s!==s.toLowerCase()&&(t+=" "),t+=0===i?s.toUpperCase():s}return t}}])&&n(i.prototype,s),l&&n(i,l),t}();t.default=l}])});